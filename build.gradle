// Top-level build file where you can add configuration options common to all sub-projects/modules.
apply plugin: 'distribution'

buildscript {
    repositories {
        jcenter()
        mavenCentral()
    }
    dependencies {
        classpath 'org.eclipse.jgit:org.eclipse.jgit:3.1.0.201310021548-r'
        classpath 'com.android.tools.build:gradle:2.0.0-rc3'
    }
}

allprojects {
    repositories {
        jcenter()
    }
}

distributions {
    main {
        contents {
            into('bin') {
                from { project(':jsettlers.network').startScripts.outputs.files }
            }
        }
    }
}

task runAndroid(dependsOn: ':build') {
    Properties local = new Properties()
    local.load(new FileInputStream("local.properties"))
    def adb = local.getProperty('sdk.dir') + '/platform-tools/adb'
    println 'Copy files to your device...'
    exec {
        commandLine adb, 'install', '-r', './jsettlers.main.android/bin/jsettlers.main.android.apk'
    }
    exec {
        commandLine adb, 'shell', 'am', 'start', '-n', 'jsettlers.main.android/jsettlers.main.android.JsettlersActivity'
    }
    println 'The application should have started now.'
}
